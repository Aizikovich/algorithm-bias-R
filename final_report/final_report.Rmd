---
title: "Final Report"
author: "Team Y"
date: "6/17/2022"
output: html_document
---

```{r load-packages, include = FALSE}
library(knitr)
library(tidyverse)
library(broom)
library(htmltools)
library(dplyr)
library("ggalluvial")
library("gridExtra") 
library(tidymodels)
library(schrute)
library(lubridate)
```

```{r}
# opts_chunk$set(echo=FALSE) # hide source code in the document
path <- setwd("..")
df <- read.csv(
  "data\\data_no_red.csv")
```
# section 1 - Intro

```{r}

target_race_me <- df %>% filter(!(hatespeech==1) & annotator_race == "white")
target_race_me <- within(target_race_me, hatespeech[hatespeech == 2] <- 1)

set.seed(1122)

df_model <- target_race_me
df_model <- subset(target_race_me, select = -c(annotator_race, comment_id, annotator_id ))


df_split <- initial_split(df_model)

train <- training(df_split)
test <- testing(df_split)

model <- glm(hatespeech ~ target_race+target_religion+target_gender+target_sexuality+annotator_age, data = train)

summary(model)
```

```{r}
library(caret)

x <- predict(model, newdata = test, type = "response")
xx <- ifelse(x < 0.5, 0, 1)

xxx <- data.frame(Predicted = xx, Actual = test$hatespeech)
xxx$Predicted <- as.factor(xxx$Predicted)

xxx$Actual <- as.factor(xxx$Actual)

caret::confusionMatrix(xxx$Predicted, xxx$Actual)

```


```{r}
target_race_me <- df %>% filter(!(hatespeech==1))
target_race_me <- within(target_race_me, hatespeech[hatespeech == 2] <- 1)

set.seed(1122)

df_model <- target_race_me
df_model <- subset(target_race_me, select = -c(annotator_race, comment_id, annotator_id ))


df_split <- initial_split(df_model)

train <- training(df_split)
test <- testing(df_split)

model <- glm(hatespeech ~ target_race+target_religion+target_gender+target_sexuality+annotator_age, data = train)
summary(model)

```
```{r}
library(caret)

x <- predict(model, newdata = test, type = "response")
xx <- ifelse(x < 0.5, 0, 1)

xxx <- data.frame(Predicted = xx, Actual = test$hatespeech)
xxx$Predicted <- as.factor(xxx$Predicted)

xxx$Actual <- as.factor(xxx$Actual)

caret::confusionMatrix(xxx$Predicted, xxx$Actual)

```
